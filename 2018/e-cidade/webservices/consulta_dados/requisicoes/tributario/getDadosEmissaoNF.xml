<?xml version='1.0' ?>
<consulta distinct="true">
  <campos>
    <campo campo="q03_ativ"                            label="cod_atividade"    />
    <campo campo="q03_descr"                           label="atividade"        />
    <campo campo="q03_deducao"                         label="deducao"          />
    <campo campo="q03_tributacao_municipio"            label="tributacao_municipio" />
    <campo campo="q71_estrutural"                      label="estrut_cnae"      />
    <campo campo="q71_descr"                           label="desc_cnae"        />
    <campo campo="db121_estrutural"                    label="cod_item_servico" />
    <campo campo="db121_descricao"                     label="desc_item_servico"/>
    <campo campo="q136_valor"                          label="aliq"             />
    <campo campo="case when q136_localpagamento = 1 then 'Sede Prestador'
                       when q136_localpagamento = 2 then 'Sede tomador'
                       when q136_localpagamento = 3 then 'Local de prestação do serviço' end"
           label="local_pgto"                                />
    <campo campo="case when q136_tipotributacao = 3 then 't' else 'f' end"                     label="tributacao_nao_incide" />
    <campo campo="q136_exercicio"                                  label="exercicio" />
  </campos>
  <from tabela="ativid"/>
  <juncoes>
    <join tipo="inner"  tabela="atividcnae"                  condicao="q03_ativ               = q74_ativid"          />
    <join tipo="inner"  tabela="cnaeanalitica"               condicao="q72_sequencial         = q74_cnaeanalitica"   />
    <join tipo="inner"  tabela="cnae"                        condicao="q71_sequencial         = q72_cnae"            />
    <join tipo="inner"  tabela="issgruposervicoativid"       condicao="q03_ativ               = q127_ativid"         />
    <join tipo="inner"  tabela="issgruposervico"             condicao="q127_issgruposerviso   = q126_sequencial"     />
    <join tipo="inner"  tabela="db_estruturavalor"           condicao="q126_db_estruturavalor = db121_sequencial"    />
    <join tipo="left"   tabela="issconfiguracaogruposervico" condicao="q126_sequencial        = q136_issgruposervico"/>
  </juncoes>
  <filtros>
    <filtro label="atividade" condicao="q03_ativ = '$atividade'" obrigatorio="true"/>
  </filtros>
  <agrupamento campos=""        />
  <ordenacao   campos="q03_ativ"/>
</consulta>